make[1]: Entering directory '/home/runner/work/moq-interop-runner/moq-interop-runner/main'
rm -rf mlog/
mkdir -p mlog/relay mlog/client
Running interop tests...
  Relay:  moxygen-interop:latest
  Client: ghcr.io/englishm/moq-interop-runner-moq-dev-rs-client:latest
RELAY_IMAGE=moxygen-interop:latest CLIENT_IMAGE=ghcr.io/englishm/moq-interop-runner-moq-dev-rs-client:latest \
	docker compose -f docker-compose.test.yml up --abort-on-container-exit
time="2026-02-14T00:30:36Z" level=warning msg="The \"PORT\" variable is not set. Defaulting to a blank string."
time="2026-02-14T00:30:36Z" level=warning msg="The \"PORT\" variable is not set. Defaulting to a blank string."
time="2026-02-14T00:30:36Z" level=warning msg="The \"PORT\" variable is not set. Defaulting to a blank string."
time="2026-02-14T00:30:36Z" level=warning msg="The \"HEX\" variable is not set. Defaulting to a blank string."
time="2026-02-14T00:30:36Z" level=warning msg="The \"HEX\" variable is not set. Defaulting to a blank string."
 Container main-relay-1  Recreate
 Container main-relay-1  Recreated
Attaching to relay-1, test-client-1
relay-1  | V0214 00:30:36.583168     7 MoQServer.cpp:95] MoQServer: Registering ALPN handlers: moqt-16, moqt-15, moq-00
test-client-1  | TAP version 14
test-client-1  | # moq-dev-rs-client v0.1.0
test-client-1  | # Relay: https://relay:4443
test-client-1  | 1..6
relay-1        | V0214 00:30:42.254751     8 MoQServer.cpp:269] MoQServer WebTransport: supported protocols: moqt-16, moqt-15
relay-1        | V0214 00:30:42.254957     8 MoQSession.cpp:2176] start sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.255180     8 MoQSession.cpp:5074] onNewBidiStream sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.255197     8 MoQSession.cpp:2548] controlReadLoop sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.255203     8 MoQSession.cpp:2267] controlWriteLoop sess=0x7fc9b4051c20
relay-1        | W0214 00:30:42.255344     8 MoQFramer.cpp:731] Peer advertised unsupported version 4279086338, supported versions are: 4278190094,4278190095,4278190096
relay-1        | W0214 00:30:42.255386     8 MoQFramer.cpp:731] Peer advertised unsupported version 4279086337, supported versions are: 4278190094,4278190095,4278190096
relay-1        | V0214 00:30:42.255428     8 MoQSession.cpp:2411] onClientSetup sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.255436     8 MoQSession.cpp:2419] Client MOQT_IMPLEMENTATION=moq-lite-rs sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.255446     8 MoQServerBase.cpp:51] MoQServerBase::ClientSetup
relay-1        | V0214 00:30:42.255455     8 MoQSession.cpp:2477] Negotiated Version=0xff00000e (draft-14)
test-client-1  | ok 1 - setup-only
test-client-1  |   ---
test-client-1  |   duration_ms: 46
test-client-1  |   ...
relay-1        | E0214 00:30:42.255899     8 MoQServer.h:129] proxygen::HTTPException: Got error=ApplicationError: 91141958510811, Server closed by peer reason=cancelled
relay-1        | V0214 00:30:42.255918     8 MoQSession.h:367] onSessionEnderr=4294967295 sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.255922     8 MoQSession.cpp:2244] close sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.255948     8 MoQSession.cpp:2164] requestCancellation from cleanup sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.255985     8 MoQSession.cpp:2260] requestCancellation from close sess=0x7fc9b4051c20
relay-1        | E20260214 00:30:42.256016     8 HQSession.cpp:530] Connection closed with error err=91141958510811 msg=Server closed by peer reason=cancelled proto=h3, UA=, client CID=f4cc4fa0e479a54c, server CID=4000000179eefce5, downstream=[::ffff:172.18.0.3]:50394, [::]:4443=local, drain=none
relay-1        | E0214 00:30:42.256717     8 MoQSession.cpp:2573] proxygen::WebTransport::Exception: received reset_stream with error=0 id=4 sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.256733     8 MoQSession.cpp:2550] exit controlReadLoop sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.256837     8 MoQSession.cpp:2269] exit controlWriteLoop sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.256877     8 MoQSession.cpp:2124] ~MoQSession sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.257539     8 MoQServer.cpp:269] MoQServer WebTransport: supported protocols: moqt-16, moqt-15
relay-1        | V0214 00:30:42.257629     8 MoQSession.cpp:2176] start sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.257886     8 MoQSession.cpp:5074] onNewBidiStream sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.257903     8 MoQSession.cpp:2548] controlReadLoop sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.257908     8 MoQSession.cpp:2267] controlWriteLoop sess=0x7fc9b4051c20
relay-1        | W0214 00:30:42.257987     8 MoQFramer.cpp:731] Peer advertised unsupported version 4279086338, supported versions are: 4278190094,4278190095,4278190096
relay-1        | W0214 00:30:42.258001     8 MoQFramer.cpp:731] Peer advertised unsupported version 4279086337, supported versions are: 4278190094,4278190095,4278190096
relay-1        | V0214 00:30:42.258007     8 MoQSession.cpp:2411] onClientSetup sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.258012     8 MoQSession.cpp:2419] Client MOQT_IMPLEMENTATION=moq-lite-rs sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.258016     8 MoQServerBase.cpp:51] MoQServerBase::ClientSetup
relay-1        | V0214 00:30:42.258023     8 MoQSession.cpp:2477] Negotiated Version=0xff00000e (draft-14)
relay-1        | V0214 00:30:42.258373     8 MoQRelaySession.cpp:688] onPublishNamespace ns=moq-test/interop sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.258394     8 MoQRelay.cpp:79] publishNamespace ns=moq-test/interop
relay-1        | V0214 00:30:42.258401     8 MoQRelaySession.cpp:751] publishNamespaceOk reqID=0 sess=0x7fc9b4051c20
test-client-1  | ok 2 - announce-only
test-client-1  |   ---
test-client-1  |   duration_ms: 504
test-client-1  |   ...
relay-1        | E0214 00:30:42.760127     8 MoQServer.h:129] proxygen::HTTPException: Got error=ApplicationError: 91141958510811, Server closed by peer reason=cancelled
relay-1        | V0214 00:30:42.760147     8 MoQSession.h:367] onSessionEnderr=4294967295 sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.760155     8 MoQSession.cpp:2244] close sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.760166     8 MoQRelay.cpp:231] publishNamespaceDone ns=moq-test/interop
relay-1        | V0214 00:30:42.760176     8 MoQRelay.cpp:224] Pruning empty subtree at: moq-test
relay-1        | V0214 00:30:42.760186     8 MoQSession.cpp:2164] requestCancellation from cleanup sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.760200     8 MoQSession.cpp:2260] requestCancellation from close sess=0x7fc9b4051c20
relay-1        | E20260214 00:30:42.760232     8 HQSession.cpp:530] Connection closed with error err=91141958510811 msg=Server closed by peer reason=cancelled proto=h3, UA=, client CID=f24f984da5c262e8, server CID=4000000b8acce25e, downstream=[::ffff:172.18.0.3]:50394, [::]:4443=local, drain=none
relay-1        | E0214 00:30:42.760449     8 MoQSession.cpp:2573] proxygen::WebTransport::Exception: received reset_stream with error=0 id=4 sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.760468     8 MoQSession.cpp:2550] exit controlReadLoop sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.760503     8 MoQSession.cpp:2269] exit controlWriteLoop sess=0x7fc9b4051c20
relay-1        | V0214 00:30:42.761809     8 MoQServer.cpp:269] MoQServer WebTransport: supported protocols: moqt-16, moqt-15
relay-1        | V0214 00:30:42.761932     8 MoQSession.cpp:2176] start sess=0x7fc9b40678e0
relay-1        | V0214 00:30:42.762129     8 MoQSession.cpp:5074] onNewBidiStream sess=0x7fc9b40678e0
relay-1        | V0214 00:30:42.762147     8 MoQSession.cpp:2548] controlReadLoop sess=0x7fc9b40678e0
relay-1        | V0214 00:30:42.762151     8 MoQSession.cpp:2267] controlWriteLoop sess=0x7fc9b40678e0
relay-1        | W0214 00:30:42.762285     8 MoQFramer.cpp:731] Peer advertised unsupported version 4279086338, supported versions are: 4278190094,4278190095,4278190096
relay-1        | W0214 00:30:42.762300     8 MoQFramer.cpp:731] Peer advertised unsupported version 4279086337, supported versions are: 4278190094,4278190095,4278190096
relay-1        | V0214 00:30:42.762307     8 MoQSession.cpp:2411] onClientSetup sess=0x7fc9b40678e0
relay-1        | V0214 00:30:42.762312     8 MoQSession.cpp:2419] Client MOQT_IMPLEMENTATION=moq-lite-rs sess=0x7fc9b40678e0
relay-1        | V0214 00:30:42.762316     8 MoQServerBase.cpp:51] MoQServerBase::ClientSetup
relay-1        | V0214 00:30:42.762325     8 MoQSession.cpp:2477] Negotiated Version=0xff00000e (draft-14)
relay-1        | V0214 00:30:42.762617     8 MoQRelaySession.cpp:688] onPublishNamespace ns=moq-test/interop sess=0x7fc9b40678e0
relay-1        | V0214 00:30:42.762632     8 MoQRelay.cpp:79] publishNamespace ns=moq-test/interop
relay-1        | V0214 00:30:42.762638     8 MoQRelaySession.cpp:751] publishNamespaceOk reqID=0 sess=0x7fc9b40678e0
relay-1        | V0214 00:30:42.769943     8 MoQSession.cpp:2124] ~MoQSession sess=0x7fc9b4051c20
relay-1        | V0214 00:30:43.263918     8 MoQRelaySession.cpp:811] onPublishNamespaceDone ns=moq-test/interop sess=0x7fc9b40678e0
relay-1        | V0214 00:30:43.263941     8 MoQRelay.cpp:231] publishNamespaceDone ns=moq-test/interop
relay-1        | V0214 00:30:43.263950     8 MoQRelay.cpp:224] Pruning empty subtree at: moq-test
test-client-1  | ok 3 - publish-namespace-done
test-client-1  |   ---
test-client-1  |   duration_ms: 704
test-client-1  |   ...
test-client-1  | ok 4 - subscribe-error # SKIP moq-lite API requires announcement before subscribe
relay-1        | E0214 00:30:43.464865     8 MoQServer.h:129] proxygen::HTTPException: Got error=ApplicationError: 91141958510811, Server closed by peer reason=cancelled
relay-1        | V0214 00:30:43.464883     8 MoQSession.h:367] onSessionEnderr=4294967295 sess=0x7fc9b40678e0
relay-1        | V0214 00:30:43.464890     8 MoQSession.cpp:2244] close sess=0x7fc9b40678e0
relay-1        | V0214 00:30:43.464897     8 MoQSession.cpp:2164] requestCancellation from cleanup sess=0x7fc9b40678e0
relay-1        | V0214 00:30:43.464908     8 MoQSession.cpp:2260] requestCancellation from close sess=0x7fc9b40678e0
relay-1        | E20260214 00:30:43.464931     8 HQSession.cpp:530] Connection closed with error err=91141958510811 msg=Server closed by peer reason=cancelled proto=h3, UA=, client CID=52b23d319d4803f7, server CID=4000001d1516b90e, downstream=[::ffff:172.18.0.3]:50394, [::]:4443=local, drain=none
relay-1        | E0214 00:30:43.465047     8 MoQSession.cpp:2573] proxygen::WebTransport::Exception: received reset_stream with error=0 id=4 sess=0x7fc9b40678e0
relay-1        | V0214 00:30:43.465059     8 MoQSession.cpp:2550] exit controlReadLoop sess=0x7fc9b40678e0
relay-1        | V0214 00:30:43.465088     8 MoQSession.cpp:2269] exit controlWriteLoop sess=0x7fc9b40678e0
relay-1        | V0214 00:30:43.465099     8 MoQSession.cpp:2124] ~MoQSession sess=0x7fc9b40678e0
relay-1        | V0214 00:30:43.466311     8 MoQServer.cpp:269] MoQServer WebTransport: supported protocols: moqt-16, moqt-15
relay-1        | V0214 00:30:43.466418     8 MoQSession.cpp:2176] start sess=0x7fc9b4064820
relay-1        | V0214 00:30:43.466606     8 MoQSession.cpp:5074] onNewBidiStream sess=0x7fc9b4064820
relay-1        | V0214 00:30:43.466624     8 MoQSession.cpp:2548] controlReadLoop sess=0x7fc9b4064820
relay-1        | V0214 00:30:43.466674     8 MoQSession.cpp:2267] controlWriteLoop sess=0x7fc9b4064820
relay-1        | W0214 00:30:43.466771     8 MoQFramer.cpp:731] Peer advertised unsupported version 4279086338, supported versions are: 4278190094,4278190095,4278190096
relay-1        | W0214 00:30:43.466786     8 MoQFramer.cpp:731] Peer advertised unsupported version 4279086337, supported versions are: 4278190094,4278190095,4278190096
relay-1        | V0214 00:30:43.466793     8 MoQSession.cpp:2411] onClientSetup sess=0x7fc9b4064820
relay-1        | V0214 00:30:43.466798     8 MoQSession.cpp:2419] Client MOQT_IMPLEMENTATION=moq-lite-rs sess=0x7fc9b4064820
relay-1        | V0214 00:30:43.466802     8 MoQServerBase.cpp:51] MoQServerBase::ClientSetup
relay-1        | V0214 00:30:43.466808     8 MoQSession.cpp:2477] Negotiated Version=0xff00000e (draft-14)
relay-1        | V0214 00:30:43.467159     8 MoQRelaySession.cpp:688] onPublishNamespace ns=moq-test/interop sess=0x7fc9b4064820
relay-1        | V0214 00:30:43.467175     8 MoQRelay.cpp:79] publishNamespace ns=moq-test/interop
relay-1        | V0214 00:30:43.467180     8 MoQRelaySession.cpp:751] publishNamespaceOk reqID=0 sess=0x7fc9b4064820
relay-1        | V0214 00:30:43.769849     8 MoQServer.cpp:269] MoQServer WebTransport: supported protocols: moqt-16, moqt-15
relay-1        | V0214 00:30:43.769974     8 MoQSession.cpp:2176] start sess=0x7fc9b406bff0
relay-1        | V0214 00:30:43.770214     8 MoQSession.cpp:5074] onNewBidiStream sess=0x7fc9b406bff0
relay-1        | V0214 00:30:43.770233     8 MoQSession.cpp:2548] controlReadLoop sess=0x7fc9b406bff0
relay-1        | V0214 00:30:43.770239     8 MoQSession.cpp:2267] controlWriteLoop sess=0x7fc9b406bff0
relay-1        | W0214 00:30:43.770326     8 MoQFramer.cpp:731] Peer advertised unsupported version 4279086338, supported versions are: 4278190094,4278190095,4278190096
relay-1        | W0214 00:30:43.770340     8 MoQFramer.cpp:731] Peer advertised unsupported version 4279086337, supported versions are: 4278190094,4278190095,4278190096
relay-1        | V0214 00:30:43.770348     8 MoQSession.cpp:2411] onClientSetup sess=0x7fc9b406bff0
relay-1        | V0214 00:30:43.770352     8 MoQSession.cpp:2419] Client MOQT_IMPLEMENTATION=moq-lite-rs sess=0x7fc9b406bff0
relay-1        | V0214 00:30:43.770356     8 MoQServerBase.cpp:51] MoQServerBase::ClientSetup
relay-1        | V0214 00:30:43.770364     8 MoQSession.cpp:2477] Negotiated Version=0xff00000e (draft-14)
test-client-1  | not ok 5 - announce-subscribe
test-client-1  |   ---
test-client-1  |   duration_ms: 1806
test-client-1  |   message: "timeout waiting for announcement"
test-client-1  |   ...
test-client-1  | ok 6 - subscribe-before-announce # SKIP moq-lite API requires announcement before subscribe
relay-1        | E0214 00:30:45.271511     8 MoQServer.h:129] proxygen::HTTPException: Got error=ApplicationError: 91141958510811, Server closed by peer reason=dropped
relay-1        | V0214 00:30:45.271589     8 MoQSession.h:367] onSessionEnderr=4294967295 sess=0x7fc9b406bff0
relay-1        | V0214 00:30:45.271617     8 MoQSession.cpp:2244] close sess=0x7fc9b406bff0
relay-1        | V0214 00:30:45.271646     8 MoQSession.cpp:2164] requestCancellation from cleanup sess=0x7fc9b406bff0
relay-1        | V0214 00:30:45.271706     8 MoQSession.cpp:2260] requestCancellation from close sess=0x7fc9b406bff0
relay-1        | E20260214 00:30:45.271739     8 HQSession.cpp:530] Connection closed with error err=91141958510811 msg=Server closed by peer reason=dropped proto=h3, UA=, client CID=2ac00bae48437fb7, server CID=400000040c34ca89, downstream=[::ffff:172.18.0.3]:50394, [::]:4443=local, drain=none
relay-1        | E0214 00:30:45.271830     8 MoQSession.cpp:2573] proxygen::WebTransport::Exception: received reset_stream with error=0 id=4 sess=0x7fc9b406bff0
relay-1        | V0214 00:30:45.271866     8 MoQSession.cpp:2550] exit controlReadLoop sess=0x7fc9b406bff0
relay-1        | V0214 00:30:45.271924     8 MoQSession.cpp:2269] exit controlWriteLoop sess=0x7fc9b406bff0
relay-1        | V0214 00:30:45.271965     8 MoQSession.cpp:2124] ~MoQSession sess=0x7fc9b406bff0
[Ktest-client-1 exited with code 1
[31m[1mAborting on container exit...[0m
 Container main-test-client-1  Stopping
 Container main-test-client-1  Stopped
 Container main-relay-1  Stopping
relay-1        | E0214 00:30:53.474303     8 MoQServer.h:129] proxygen::HTTPException: Got error=LocalError: Idle timeout, Idle timeout: 10 seconds timeout
relay-1        | V0214 00:30:53.474324     8 MoQSession.h:367] onSessionEnderr=4294967295 sess=0x7fc9b4064820
relay-1        | V0214 00:30:53.474328     8 MoQSession.cpp:2244] close sess=0x7fc9b4064820
relay-1        | V0214 00:30:53.474335     8 MoQRelay.cpp:231] publishNamespaceDone ns=moq-test/interop
relay-1        | V0214 00:30:53.474341     8 MoQRelay.cpp:224] Pruning empty subtree at: moq-test
relay-1        | V0214 00:30:53.474346     8 MoQSession.cpp:2164] requestCancellation from cleanup sess=0x7fc9b4064820
relay-1        | V0214 00:30:53.474356     8 MoQSession.cpp:2260] requestCancellation from close sess=0x7fc9b4064820
relay-1        | E0214 00:30:53.474400     8 MoQSession.cpp:2573] proxygen::WebTransport::Exception: quic error with error=4294967295 id=4 sess=0x7fc9b4064820
relay-1        | V0214 00:30:53.474412     8 MoQSession.cpp:2550] exit controlReadLoop sess=0x7fc9b4064820
relay-1        | V0214 00:30:53.474459     8 MoQSession.cpp:2269] exit controlWriteLoop sess=0x7fc9b4064820
relay-1        | V0214 00:30:53.484635     8 MoQSession.cpp:2124] ~MoQSession sess=0x7fc9b4064820
 Container main-relay-1  Stopped
[Krelay-1 exited with code 137

make[1]: *** [Makefile:65: test] Error 1
make[1]: Leaving directory '/home/runner/work/moq-interop-runner/moq-interop-runner/main'
